{% extends 'PiggyBoxShopBundle::layout.html.twig'%}


{% block body%}

{% include 'PiggyBoxShopBundle:Product:product_sub_header.html.twig' %}

<div id="main">
	<div id="primary" class="site-content container">


	<div class="page-header">
		<h1>{{product.name}}</h1>
	</div>


	<form class="form-horizontal" action="{{ path('monmagasin_mesproduits_update', {'id': product.id}) }}" method="post" {{ form_enctype(edit_form) }}>
	{{ form_errors(edit_form) }}
		<div class="box box-margined">
		    <div class="row-fluid">

		    	<div class="span4">
		    		<img src="{{product.getWebPath | apply_filter('large_thumb') }}" class="img240x240">
		    	</div>

				<div class="span8">

						<div class="control-group">
							<label class="control-label" for="inputName">Nom du produit</label>
							<div class="controls">
								{{ form_widget(edit_form.name, { 'attr': {'class': 'span12','placeholder':'Nom du produit...'} }) }}
							</div>
						</div>

						<div class="control-group">
							<label class="control-label" for="inputDesc">Description</label>
							<div class="controls">
								{{ form_widget(edit_form.description, { 'attr': {'class': 'span12', 'rows': '3'} }) }}
							</div>
						</div>

						<div class="control-group">
							<label class="control-label" for="inputDesc">Catégorie</label>
							<div class="controls">
								{{ form_widget(edit_form.category, { 'attr': {'class': 'span12'} }) }}
							</div>
						</div>

						<div class="control-group">
							<label class="control-label" for="inputDesc">Changer la photo</label>
							<div class="controls">
								{{ form_widget(edit_form.file, { 'attr': {'class': 'span12'} }) }}
							</div>
						</div>

						{% if product.prices|length >0 %}
							{% for price in edit_form.prices %}
								{% if price.slice_nbr.vars.value == '' %}
									<!-- ########### DEBUT PRIX 1 ####### -->
									<div id="unit-pricing-container" class="row-fluid">
										<div class="span12">
											<div class="form-inline form-huge">
												<div class="row-fluid">
													<div class="span4 offset2">
														<h3 class="no-margin text-centered">Prix Unitaire</h3>
													</div>

													<div class="span4">
														<h3 class="no-margin text-centered">Prix au Kilo</h3>
													</div>
												</div>

												<div class="row-fluid">
													<div class="span4 offset2">
														{{ form_widget(price.price, { 'attr': {'class': 'span12 text-centered','placeholder':'Ex: 3.59'} }) }}
													</div>
													<div class="span4">
														{{ form_widget(edit_form.price_kg, { 'attr': {'class': 'span12 text-centered','placeholder':'Ex: 11.99'} }) }}
													</div>
												</div>
											</div>
										</div>
									</div>
									<!-- ########### FIN PRIX 1 ####### -->
								{% else %}
								<!-- ########### DEBUT PRIX 3 ####### -->
									<div id="multiple-pricing-container" class="row-fluid">
										<div class="span12">
											<div class="form-inline">
												<table class="table table-bordered">
													<tr>
														<th>Coupe / pièce</th>
														<th>Poids total</th>
														<th>Prix</th>
														<th>Prix / Kg</th>
													</tr>
													<tr>
														<td>
															{{ form_widget(price.slice_nbr, { 'attr': {'class': 'input-small','placeholder':'Nom du produit...'} }) }}
														</td>
														<td>
															{{ form_widget(price.total_weight, { 'attr': {'class': '','placeholder':'Nom du produit...'} }) }}

														</td>
														<td>
															{{ form_widget(price.price, { 'attr': {'class': 'input-small','placeholder':'Nom du produit...'} }) }}
														</td>
														<td>
															{{ form_widget(edit_form.price_kg, { 'attr': {'class': 'input-small','placeholder':'Nom du produit...'} }) }}
														</td>
													</tr>
												</table>
											</div>
										</div>
									</div>
									<!-- ########### FIN PRIX 3 ####### -->
								{% endif %}
							{% endfor %}

						{% else %}

						<!-- ########### DEBUT PRIX 2 ####### -->
						<div id="kg-pricing-container" class="row-fluid">
							<div class="span12">
								<div class="form-inline form-huge">
									<div class="row-fluid">
										<div class="span4 offset4">
											<h3 class="no-margin text-centered">Prix au Kg</h3>
										</div>
									</div>

									<div class="row-fluid">
										<div class="span4 offset4">
											{{ form_widget(edit_form.price_kg, { 'attr': {'class': 'span12 text-centered','placeholder':'Ex: 3.59'} }) }}
										</div>
									</div>
								</div>
							</div>
						</div>
						<!-- ########### FIN PRIX 2 ####### -->
						{% endif %}

						<hr />
						<div class="row-fluid">
							<div class="span9">
								<button class="btn btn-large btn-block btn-primary">
									<i class="icon-ok icon-white"></i>
									Enregistrer les modifications
								</button>
							</div>
						</div>


				</div>

		    </div>
		</div>

{{ form_widget(edit_form._token) }}

</form>
<form class="form-horizontal" action="{{ path('monmagasin_mesproduits_delete', {'id': delete_form.vars.value.id}) }}" method="post" {{ form_enctype(delete_form) }}>
	<div class="row-fluid">
		<div class="span3">
			<a id="show-delete-product-confirmation" class="btn btn-large btn-block btn-danger"><i class="icon-trash icon-white"></i> Supprimer</a>
		</div>

		<div id="delete-product-confirmation-container" class="span9 hide">
			<div class="row-fluid">
				{{ form_widget(delete_form) }}
				<div class="span12">
					<h4 style="margin-top: 0;">Etes-vous certain de vouloir supprimer le produit <em>"{{product.name}}"</em></h4>
				</div>
				<div class="span4">
					<a id="hide-delete-product-confirmation" class="btn btn-block"><i class="icon-remove"></i> Annuler</a>
				</div>
				<div class="span7">
					<button class="btn btn-block btn-danger"><i class="icon-trash icon-white"></i> Supprimer définitivement</button>
				</div>
			</div>
		</div>

	</div>
</form>
    </div>
</div>
{% endblock %}

{% block javascript %}
{{parent()}}

<script type="text/javascript">
	// Delete: ask for confirmation
	$("#show-delete-product-confirmation").click(function() {
	  $('#delete-product-confirmation-container').show(400);
	});

	// Cancel: hide confirmation
	$("#hide-delete-product-confirmation").click(function() {
	  $('#delete-product-confirmation-container').hide('fast');
	});
</script>

{% endblock %}